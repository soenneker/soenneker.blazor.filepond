@page "/"
@using Soenneker.Blazor.FilePond
@using Soenneker.Blazor.FilePond.Dtos
@using Microsoft.Extensions.Logging
@using System.IO
@using Soenneker.Blazor.FilePond.Options
@using Soenneker.Extensions.String
@using Soenneker.Utils.Random
@inject ILogger<Index> Logger

<div class="demo-container">
    <header class="demo-header">
        <div class="header-content">
            <div class="logo-container">
                <img src="https://user-images.githubusercontent.com/4441470/224455560-91ed3ee7-f510-4041-a8d2-3fc093025112.png" alt="FilePond Logo" class="logo" />
            </div>
            <h1 class="demo-title">Soenneker.Blazor.FilePond Demo</h1>
            <p class="demo-subtitle">Explore the comprehensive features and capabilities of our professional FilePond component for Blazor applications.</p>
        </div>
    </header>

    <div class="demo-grid">
        <section class="demo-card main-section">
            <div class="card-header">
                <div class="card-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="card-title-group">
                    <h2 class="card-title">File Upload Interface</h2>
                    <p class="card-description">Drag and drop files or click to browse. Supports images, videos, and documents.</p>
                </div>
            </div>
            
            <div class="filepond-container">
                <FilePond @ref="FilePond" Options="_options" OnInit="OnInit" OnAddFile="OnAddFile" OnInitFile="OnInitFile" OnBeforeAddFile="OnBeforeAddFile">
                </FilePond>
            </div>
        </section>

        <section class="demo-card file-operations-section">
            <div class="card-header">
                <div class="card-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="card-title-group">
                    <h2 class="card-title">File Operations</h2>
                    <p class="card-description">Add, remove, and manage files programmatically</p>
                </div>
            </div>
            
            <div class="action-group">
                <button @onclick="AddFile" class="action-btn action-btn--primary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Add File
                </button>
                <button @onclick="AddFileSilently" class="action-btn action-btn--primary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Add File Silently
                </button>
                <button @onclick="AddFileFromStream" class="action-btn action-btn--primary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Add From Stream
                </button>
                <button @onclick="AddLimboFile" class="action-btn action-btn--info">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Add Limbo File
                </button>
                <button @onclick="AddFiles" class="action-btn action-btn--primary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 16H16.01M12 12H12.01M8 8H8.01M3 12C3 13.1819 3.23279 14.3522 3.68508 15.4442C4.13738 16.5361 4.80031 17.5282 5.63604 18.364C6.47177 19.1997 7.46392 19.8626 8.55585 20.3149C9.64778 20.7672 10.8181 21 12 21C13.1819 21 14.3522 20.7672 15.4442 20.3149C16.5361 19.8626 17.5282 19.1997 18.364 18.364C19.1997 17.5282 19.8626 16.5361 20.3149 15.4442C20.7672 14.3522 21 13.1819 21 12C21 10.8181 20.7672 9.64778 20.3149 8.55585C19.8626 7.46392 19.1997 6.47177 18.364 5.63604C17.5282 4.80031 16.5361 4.13738 15.4442 3.68508C14.3522 3.23279 13.1819 3 12 3C10.8181 3 9.64778 3.23279 8.55585 3.68508C7.46392 4.13738 6.47177 4.80031 5.63604 5.63604C4.80031 6.47177 4.13738 7.46392 3.68508 8.55585C3.23279 9.64778 3 10.8181 3 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Add Multiple Files
                </button>
            </div>
        </section>

        <section class="demo-card file-management-section">
            <div class="card-header">
                <div class="card-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 6H5H21M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="card-title-group">
                    <h2 class="card-title">File Management</h2>
                    <p class="card-description">Retrieve, remove, and manage existing files</p>
                </div>
            </div>
            
            <div class="action-group">
                <button @onclick="Browse" class="action-btn action-btn--info">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 7V5A2 2 0 0 1 5 3H7M7 3V11M7 3H11M7 11H11M7 11V19A2 2 0 0 0 9 21H15A2 2 0 0 0 17 19V11M17 11H21M17 11V3H21M17 3H13M17 3V11M13 3V11M13 3H11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Browse Files
                </button>
                <button @onclick="GetFile" class="action-btn action-btn--secondary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Get File
                </button>
                <button @onclick="GetFiles" class="action-btn action-btn--secondary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Get All Files
                </button>
                <button @onclick="RemoveFile" class="action-btn action-btn--danger">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 6H5H21M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Remove File
                </button>
                <button @onclick="RemoveFiles" class="action-btn action-btn--danger">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 6H5H21M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Remove All Files
                </button>
            </div>
        </section>

        <section class="demo-card advanced-section">
            <div class="card-header">
                <div class="card-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.22 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22H15C20 22 22 20 22 15V12.22C22 11.63 21.37 11 20.78 11H19V9C19 4 17 2 12 2H11V3.22C11 3.82 10.37 4.45 9.78 4.45H8V6C8 6.55 7.55 7 7 7H5V8.22C5 8.82 4.37 9.45 3.78 9.45H2V12.22C2 12.82 2.63 13.45 3.22 13.45H4V15C4 15.55 4.45 16 5 16H6V17.78C6 18.38 6.63 19 7.22 19H10V20C10 20.55 10.45 21 11 21H13C13.55 21 14 20.55 14 20V19H16.78C17.38 19 18 18.37 18 17.78V15H19C19.55 15 20 14.55 20 14V12H21.78C22.38 12 23 11.37 23 10.78V8.22C23 7.62 22.37 7 21.78 7H20V6C20 5.45 19.55 5 19 5H17V3.22C17 2.62 16.37 2 15.78 2H12.22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="card-title-group">
                    <h2 class="card-title">Advanced Features</h2>
                    <p class="card-description">Stream handling, file options, and component lifecycle</p>
                </div>
            </div>
            
            <div class="action-group">
                <button @onclick="GetStreamForFile" class="action-btn action-btn--info">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Get Stream
                </button>
                <button @onclick="AddFileWithHiddenSize" class="action-btn action-btn--warning">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.29 3.86L1.82 18A2 2 0 0 0 3.61 21H20.4A2 2 0 0 0 22.19 18L13.72 3.86A2 2 0 0 0 10.29 3.86Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <line x1="12" y1="9" x2="12" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <line x1="12" y1="17" x2="12.01" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Add (Hidden Size)
                </button>
                <button @onclick="AddFileWithVisibleSize" class="action-btn action-btn--warning">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.29 3.86L1.82 18A2 2 0 0 0 3.61 21H20.4A2 2 0 0 0 22.19 18L13.72 3.86A2 2 0 0 0 10.29 3.86Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <line x1="12" y1="9" x2="12" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <line x1="12" y1="17" x2="12.01" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Add (Visible Size)
                </button>
                <button @onclick="Create" class="action-btn action-btn--success">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Create Component
                </button>
                <button @onclick="Dispose" class="action-btn action-btn--danger">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Dispose Component
                </button>
            </div>
        </section>

        <section class="demo-card navigation-section">
            <div class="card-header">
                <div class="card-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 12L5 10M5 10L12 3L19 10M5 10V20C5 20.5523 5.44772 21 6 21H9M19 10L21 12M19 10V20C19 20.5523 18.5523 21 18 21H15M9 21C9.55228 21 10 20.5523 10 20V16C10 15.4477 10.4477 15 11 15H13C13.5523 15 14 15.4477 14 16V20C14 20.5523 14.4477 21 15 21M9 21H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="card-title-group">
                    <h2 class="card-title">Navigation</h2>
                    <p class="card-description">Explore other demo pages and features</p>
                </div>
            </div>
            
            <div class="action-group">
                <NavLink href="/second" class="action-btn action-btn--primary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Second Page
                </NavLink>
                <NavLink href="/validation-demo" class="action-btn action-btn--success">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Validation Demo
                </NavLink>
                <NavLink href="/limbo-file-demo" class="action-btn action-btn--info">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Limbo File Demo
                </NavLink>
            </div>
        </section>
    </div>
</div>

<style>
    /* Modern CSS Reset and Base Styles */
    * {
        box-sizing: border-box;
    }

    /* Container and Layout */
    .demo-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem 1rem;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        line-height: 1.6;
        color: #1a1a1a;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        min-height: 100vh;
    }

    /* Header Section */
    .demo-header {
        text-align: center;
        margin-bottom: 3rem;
        padding: 2rem 0;
    }

    .header-content {
        max-width: 800px;
        margin: 0 auto;
    }

    .logo-container {
        margin-bottom: 1.5rem;
    }

    .logo {
        height: 60px;
        width: auto;
        filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
    }

    .demo-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin: 0 0 1rem 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -0.025em;
    }

    .demo-subtitle {
        font-size: 1.125rem;
        color: #64748b;
        margin: 0;
        font-weight: 400;
        line-height: 1.7;
    }

    /* Grid Layout */
    .demo-grid {
        display: grid;
        gap: 2rem;
        grid-template-columns: 1fr;
    }

    @@media (min-width: 768px) {
        .demo-grid {
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        }
    }

    /* Main section spans full width */
    .main-section {
        grid-column: 1 / -1;
    }

    /* Card Design */
    .demo-card {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
    }

    .demo-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
    }

    .demo-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    /* Card Header */
    .card-header {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .card-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 48px;
        height: 48px;
        border-radius: 12px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        flex-shrink: 0;
    }

    .card-title-group {
        flex: 1;
    }

    .card-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin: 0 0 0.5rem 0;
        color: #1e293b;
    }

    .card-description {
        font-size: 0.875rem;
        color: #64748b;
        margin: 0;
        line-height: 1.5;
    }

    /* Action Buttons */
    .action-group {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1.5rem;
    }

    .action-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.25rem;
        border: none;
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        text-decoration: none;
        position: relative;
        overflow: hidden;
        min-height: 44px;
    }

    .action-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s;
    }

    .action-btn:hover::before {
        left: 100%;
    }

    .action-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .action-btn:active {
        transform: translateY(0);
    }

    /* Button Variants */
    .action-btn--primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    .action-btn--success {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
    }

    .action-btn--danger {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: white;
    }

    .action-btn--warning {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        color: white;
    }

    .action-btn--secondary {
        background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        color: white;
    }

    .action-btn--info {
        background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
        color: white;
    }

    /* Responsive Design */
    @@media (max-width: 640px) {
        .demo-container {
            padding: 1rem 0.5rem;
        }

        .demo-title {
            font-size: 2rem;
        }

        .demo-card {
            padding: 1.5rem;
        }

        .action-group {
            flex-direction: column;
        }

        .action-btn {
            width: 100%;
            justify-content: center;
        }
    }

    /* Focus States for Accessibility */
    .action-btn:focus {
        outline: 2px solid #667eea;
        outline-offset: 2px;
    }

    /* Loading States */
    .action-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #f1f5f9;
    }

    ::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
    }
</style>

@code{
    private FilePond? FilePond { get; set; }

    private readonly FilePondOptions _options = new()
    {
        //EnabledPlugins = [FilePondPluginType.ImagePreview, FilePondPluginType.MediaPreview],
        MaxFileSize = 100_000_000,
        UseCdn = false
    };

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await FilePond!.AddFile(GetRandomImageUri());
        }
    }

    private void OnInit()
    {
        Logger.LogInformation("OnInit fired");
    }

    private async Task Create()
    {
        await FilePond!.Create();
    }

    private async Task AddFile()
    {
        await FilePond!.AddFile(GetRandomImageUri());

    }

    private async Task AddFileSilently()
    {
        await FilePond!.AddFile(GetRandomImageUri(), true);
    }

    private static string GetRandomImageUri()
    {
        int fileHeight = RandomUtil.Next(200, 500);
        int fileWidth = RandomUtil.Next(200, 500);

        return $"https://picsum.photos/{fileHeight}/{fileWidth}";
    }

    private async Task AddFileFromStream()
    {
        const string test = "Hello world";
        var stream = test.ToMemoryStream();
        await FilePond!.AddFile(stream);
        await stream.DisposeAsync();
    }

    private async Task AddLimboFile()
    {
        await FilePond!.AddLimboFile("test-limbo-file.txt", new FilePondAddFileOptions() { ShowFileSize = false, MimeType = "text/plain"});
        await FilePond.SetAllFilesSuccessWhenReady();
    }

    private async Task AddFiles()
    {
        await FilePond!.AddFiles([
            GetRandomImageUri(),
            GetRandomImageUri()
        ]);
    }

    private async Task AddFileWithHiddenSize()
    {
        var options = new FilePondAddFileOptions
        {
            ShowFileSize = false
        };
        await FilePond!.AddFile(GetRandomImageUri(), options);
    }

    private async Task AddFileWithVisibleSize()
    {
        var options = new FilePondAddFileOptions
        {
            ShowFileSize = true
        };
        await FilePond!.AddFile(GetRandomImageUri(), options);
    }

    private async Task GetFile()
    {
        FilePondFileItem? result = await FilePond!.GetFile();
    }

    private async Task Browse()
    {
        await FilePond!.Browse();
    }

    private async Task GetStreamForFile()
    {
        Stream? stream = await FilePond!.GetStreamForFile();
        await stream!.DisposeAsync();
    }

    private async Task GetFiles()
    {
        List<FilePondFileItem>? result = await FilePond!.GetFiles();
    }

    private async Task RemoveFile()
    {
        await FilePond!.RemoveFile();
    }

    private async Task RemoveFiles()
    {
        await FilePond!.RemoveFiles();
    }

    private async Task Dispose()
    {
        await FilePond!.Destroy();
    }

    private async Task OnAddFile((FilePondError? error, FilePondFileItem fileItem) obj)
    {
        Logger.LogInformation("OnAddFile fired: Filename: {fileName}", obj.fileItem.Filename);

        Stream? stream = await FilePond!.GetStreamForFile();
        FilePondFileItem? file = await FilePond.GetFile();

        if (stream == null || file == null)
        {
            Logger.LogWarning("Skipping file upload because stream or file was null");
            return;
        }

        // do something with the stream

        await stream.DisposeAsync();
    }

    private void OnInitFile(FilePondFileItem file)
    {
        Logger.LogInformation("OnInitFile fired: Filename: {fileName}", file.Filename);
    }

    private ValueTask<bool> OnBeforeAddFile(FilePondFileItem file)
    {
        Logger.LogInformation("OnBeforeAddFile fired: Filename: {fileName}", file.Filename);

        return ValueTask.FromResult(true);
    }

    private ValueTask<string> OnFileRename(FilePondFileRenameInfo file)
    {
        Logger.LogInformation("OnFileRename fired: Filename: {fileName}", file.Name);

        return ValueTask.FromResult("test");
    }
}
